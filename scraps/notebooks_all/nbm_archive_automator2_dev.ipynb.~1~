{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "import shutil\n",
    "import shlex\n",
    "import subprocess\n",
    "import sys, os, gc\n",
    "import numpy as np\n",
    "import xarray as xr\n",
    "import pandas as pd\n",
    "import multiprocessing as mp\n",
    "\n",
    "from glob import glob\n",
    "from io import StringIO\n",
    "from datetime import datetime, timedelta\n",
    "\n",
    "core_limit = 80"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "nbm_dir = '/scratch/general/lustre/u1070830/nbm/'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "nbm_extract = np.array(sorted(glob(nbm_dir + 'extract/*.nc')))\n",
    "nbm_agg = np.array(sorted(glob(nbm_dir + 'agg/*.nc')))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "datetime.datetime(2020, 9, 30, 12, 0)"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Most recent run in archive\n",
    "try:\n",
    "    with xr.open_dataset(sorted([f for f in nbm_agg if 'f024' in f])[-1]) as sample:\n",
    "\n",
    "        if sample.init.size > 1:\n",
    "            most_recent_agg = pd.to_datetime(sample.init[-1].values)\n",
    "        else:\n",
    "            most_recent_agg = pd.to_datetime(sample.init.values)\n",
    "except:\n",
    "    # Start fresh/NBM 4.0 start date\n",
    "    most_recent_agg = datetime(2020, 9, 30, 12, 0)\n",
    "\n",
    "most_recent_agg"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Fill from: 2020-09-30 12:00:00\n",
      "Fill to: 2021-06-02 12:00:00\n"
     ]
    }
   ],
   "source": [
    "# Most recent run available\n",
    "nbm_upload_lag = 6\n",
    "most_recent_time = datetime.utcnow()\n",
    "\n",
    "roundUp = True if most_recent_time.minute < 30 else False\n",
    "\n",
    "most_recent_time = most_recent_time.replace(minute=0, second=0, microsecond=0)\n",
    "\n",
    "if roundUp:\n",
    "    most_recent_time += timedelta(hours=1)\n",
    "    \n",
    "# Round down to nearest 0, 6, 12, 18, then grab the run prior\n",
    "most_recent_time -= timedelta(hours=(most_recent_time.hour%6)+6)\n",
    "\n",
    "print('Fill from:', most_recent_agg)\n",
    "print('Fill to:', most_recent_time)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Newer NBM Available\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "DatetimeIndex(['2020-09-30 18:00:00', '2020-10-01 00:00:00',\n",
       "               '2020-10-01 06:00:00', '2020-10-01 12:00:00',\n",
       "               '2020-10-01 18:00:00', '2020-10-02 00:00:00',\n",
       "               '2020-10-02 06:00:00', '2020-10-02 12:00:00',\n",
       "               '2020-10-02 18:00:00', '2020-10-03 00:00:00',\n",
       "               ...\n",
       "               '2021-05-31 06:00:00', '2021-05-31 12:00:00',\n",
       "               '2021-05-31 18:00:00', '2021-06-01 00:00:00',\n",
       "               '2021-06-01 06:00:00', '2021-06-01 12:00:00',\n",
       "               '2021-06-01 18:00:00', '2021-06-02 00:00:00',\n",
       "               '2021-06-02 06:00:00', '2021-06-02 12:00:00'],\n",
       "              dtype='datetime64[ns]', length=980, freq='6H')"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# if last_nbm_download > last_nbm_agg:\n",
    "if np.datetime64(most_recent_time) > most_recent_agg:\n",
    "    \n",
    "    print('Newer NBM Available')    \n",
    "    # fill_runs = pd.date_range(last_nbm_agg, last_nbm_download, freq='6H')\n",
    "    fill_runs = pd.date_range(most_recent_agg, most_recent_time, freq='6H')[1:]\n",
    "    \n",
    "fill_runs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/uufs/chpc.utah.edu/common/home/u1070830/anaconda3/envs/xlab/bin/python /uufs/chpc.utah.edu/common/home/u1070830/code/model-tools/nbm/get_nbm_gribs_aws.py 202009301800 202106021200\n"
     ]
    }
   ],
   "source": [
    "# Call the NBM download here\n",
    "python = '/uufs/chpc.utah.edu/common/home/u1070830/anaconda3/envs/xlab/bin/python '\n",
    "dl_script = '/uufs/chpc.utah.edu/common/home/u1070830/code/model-tools/nbm/get_nbm_gribs_aws.py ' \n",
    "\n",
    "dl_start, dl_end = pd.to_datetime(fill_runs[0]), pd.to_datetime(fill_runs[-1])\n",
    "dl_start, dl_end = [datetime.strftime(t, '%Y%m%d%H%M') for t in [dl_start, dl_end]]\n",
    "\n",
    "cmd = python + dl_script + '%s %s'%(dl_start, dl_end)\n",
    "print(cmd)\n",
    "# subprocess.call(shlex.split(cmd))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/scratch/general/lustre/u1070830/nbm/20210208/blend.t18z.qmd.f096.WR.grib2\n"
     ]
    },
    {
     "ename": "ValueError",
     "evalue": "must supply at least one object to concatenate",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mStopIteration\u001b[0m                             Traceback (most recent call last)",
      "\u001b[0;32m~/anaconda3/envs/xlab/lib/python3.8/site-packages/xarray/core/concat.py\u001b[0m in \u001b[0;36mconcat\u001b[0;34m(objs, dim, data_vars, coords, compat, positions, fill_value, join, combine_attrs)\u001b[0m\n\u001b[1;32m    171\u001b[0m     \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 172\u001b[0;31m         \u001b[0mfirst_obj\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mobjs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mutils\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpeek_at\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mobjs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    173\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0mStopIteration\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/anaconda3/envs/xlab/lib/python3.8/site-packages/xarray/core/utils.py\u001b[0m in \u001b[0;36mpeek_at\u001b[0;34m(iterable)\u001b[0m\n\u001b[1;32m    182\u001b[0m     \u001b[0mgen\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0miter\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0miterable\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 183\u001b[0;31m     \u001b[0mpeek\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnext\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mgen\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    184\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mpeek\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mitertools\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mchain\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mpeek\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mgen\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mStopIteration\u001b[0m: ",
      "\nDuring handling of the above exception, another exception occurred:\n",
      "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-23-4e58927ba127>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m     76\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     77\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlist_new_extracts\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m500\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 78\u001b[0;31m \u001b[0mextract_fhr_data\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlist_new_extracts\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m500\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[0;32m<ipython-input-23-4e58927ba127>\u001b[0m in \u001b[0;36mextract_fhr_data\u001b[0;34m(f, interval, keep_percentiles)\u001b[0m\n\u001b[1;32m     58\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     59\u001b[0m     \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 60\u001b[0;31m         \u001b[0mdata\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mxr\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mconcat\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdata\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdim\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'threshold'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     61\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     62\u001b[0m     \u001b[0;32mexcept\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/anaconda3/envs/xlab/lib/python3.8/site-packages/xarray/core/concat.py\u001b[0m in \u001b[0;36mconcat\u001b[0;34m(objs, dim, data_vars, coords, compat, positions, fill_value, join, combine_attrs)\u001b[0m\n\u001b[1;32m    172\u001b[0m         \u001b[0mfirst_obj\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mobjs\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mutils\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpeek_at\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mobjs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    173\u001b[0m     \u001b[0;32mexcept\u001b[0m \u001b[0mStopIteration\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 174\u001b[0;31m         \u001b[0;32mraise\u001b[0m \u001b[0mValueError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"must supply at least one object to concatenate\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    175\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    176\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mcompat\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32min\u001b[0m \u001b[0m_VALID_COMPAT\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mValueError\u001b[0m: must supply at least one object to concatenate"
     ]
    }
   ],
   "source": [
    "def extract_fhr_data(f, interval=24, keep_percentiles=[]): \n",
    "    import pygrib\n",
    "\n",
    "    data = []\n",
    "    \n",
    "    with pygrib.open(f) as grb:\n",
    "        \n",
    "        fhr = int(f.split('.')[3].replace('f', ''))\n",
    "        \n",
    "        for msg in grb.read():\n",
    "            \n",
    "            step = timedelta(hours=msg.endStep - msg.startStep)\n",
    "            lead = msg.endStep\n",
    "            \n",
    "            if (fhr == lead) & (step == timedelta(hours=interval)):\n",
    "                \n",
    "                lats, lons = msg.latlons()\n",
    "\n",
    "                if 'probability' in str(msg).lower():\n",
    "                    \n",
    "                    init = datetime.strptime(str(msg.dataDate) + '%04d'%msg.dataTime, '%Y%m%d%H%M')                    \n",
    "                    valid = datetime.strptime(str(msg.validityDate) + '%04d'%msg.validityTime, '%Y%m%d%H%M')\n",
    "\n",
    "                    threshold = msg.upperLimit\n",
    "                    threshold_in = round(threshold/25.4, 2)\n",
    "\n",
    "                    if threshold_in <= 4.0:\n",
    "\n",
    "                        # print(init, valid, threshold, lead, threshold_in)\n",
    "                        \n",
    "                        idata = xr.DataArray([msg.data()[0].astype(np.float32)], name='probx',\n",
    "                                                     dims=('valid', 'y', 'x'), \n",
    "                                                     coords={'valid':[valid],\n",
    "                                                             'lat':(('y', 'x'), lats), \n",
    "                                                             'lon':(('y', 'x'), lons)})\n",
    "                        idata['init'] = init                        \n",
    "                        idata['interval'] = interval\n",
    "                        idata['step'] = step\n",
    "                        idata['fhr'] = lead\n",
    "                        \n",
    "                        idata['threshold'] = threshold\n",
    "                        idata['threshold_in'] = threshold_in\n",
    "                        \n",
    "                        # Manually fix encoding issues...\n",
    "                        idata['init'].encoding['units'] = 'hours since 2000-01-01 00:00:00'\n",
    "                        idata['valid'].encoding['units'] = 'hours since 2000-01-01 00:00:00'\n",
    "                        \n",
    "                        data.append(idata)\n",
    "\n",
    "                elif 'percentileValue' in msg.keys():\n",
    "                    \n",
    "                    if msg.percentileValue in keep_percentiles:\n",
    "                        \n",
    "                        # Append this data later with similar code as above, for now pass\n",
    "                        # print(msg.percentileValue, msg)\n",
    "                        \n",
    "                        pass\n",
    "    \n",
    "    try:\n",
    "        data = xr.concat(data, dim='threshold')    \n",
    "    \n",
    "    except:\n",
    "        raise\n",
    "        pass\n",
    "    \n",
    "    else:\n",
    "        out_file = 'blend.%s.t%02dz.qmd.f%03d.WR.nc'%(init.strftime('%Y%m%d'), init.hour, lead)\n",
    "\n",
    "        data.to_netcdf(nbm_dir + 'extract/' + out_file, unlimited_dims='valid')\n",
    "        print(out_file, 'saved')\n",
    "\n",
    "        del data\n",
    "        gc.collect()\n",
    "\n",
    "    return None\n",
    "\n",
    "print(list_new_extracts[500])\n",
    "extract_fhr_data(list_new_extracts[500])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['/scratch/general/lustre/u1070830/nbm/20201001/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201001/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201001/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201001/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201002/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201002/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201002/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201002/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201003/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201003/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201003/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201003/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201004/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201004/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201004/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201004/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201005/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201005/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201005/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201005/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201006/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201006/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201006/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201006/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201007/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201007/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201007/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201007/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201008/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201008/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201008/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201008/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201009/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201009/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201009/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201009/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201010/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201010/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201010/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201010/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201011/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201011/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201011/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201011/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201012/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201012/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201012/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201012/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201013/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201013/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201013/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201013/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201014/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201014/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201014/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201014/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201015/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201015/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201015/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201015/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201016/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201016/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201016/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201016/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201017/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201017/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201017/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201017/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201018/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201018/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201018/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201018/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201019/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201019/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201019/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201019/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201020/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201020/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201020/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201020/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201021/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201021/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201021/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201021/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201022/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201026/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201026/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201026/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201026/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201027/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201027/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201027/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201027/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201028/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201028/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201028/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201028/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201029/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201029/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201029/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201029/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201030/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201030/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201030/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201030/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201031/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201031/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201031/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201031/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201101/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201101/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201101/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201101/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201102/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201102/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201102/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201102/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201103/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201103/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201103/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201103/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201104/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201104/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201104/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201104/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201105/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201105/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201105/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201105/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201106/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201106/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201106/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201106/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201107/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201107/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201107/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201107/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201108/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201108/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201108/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201108/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201109/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201109/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201109/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201109/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201110/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201110/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201110/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201110/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201111/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201111/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201111/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201111/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201112/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201112/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201112/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201112/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201113/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201113/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201113/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201113/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201114/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201114/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201114/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201114/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201115/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201115/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201115/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201115/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201116/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201116/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201116/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201116/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201117/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201117/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201117/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201117/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201118/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201118/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201118/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201118/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201119/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201119/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201119/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201119/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201120/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201120/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201120/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201120/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201121/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201121/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201121/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201121/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201122/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201122/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201122/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201122/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201123/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201123/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201123/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201123/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201124/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201124/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201124/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201124/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201125/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201125/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201125/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201125/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201126/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201126/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201126/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201126/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201127/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201127/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201127/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201127/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201128/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201128/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201128/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201128/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201129/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201129/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201129/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201129/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201130/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201130/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201130/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201130/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201201/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201201/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201201/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201201/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201202/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201202/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201202/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201202/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201203/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201203/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201203/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201203/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201204/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201204/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201204/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201204/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201205/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201205/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201205/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201205/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201206/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201206/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201206/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201206/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201207/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201207/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201207/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201207/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201208/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201208/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201208/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201208/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201209/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201209/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201209/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201209/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201210/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201210/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201210/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201210/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201211/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201211/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201211/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201212/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201212/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201212/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201212/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201213/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201213/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201213/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201213/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201214/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201214/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201214/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201214/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201215/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201215/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201215/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201215/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201216/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201216/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201216/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201216/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201217/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201217/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201217/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201217/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201218/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201218/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201218/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201218/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201219/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201219/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201219/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201219/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201220/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201220/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201220/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201220/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201221/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201221/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201221/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201221/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201222/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201222/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201222/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201222/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201223/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201223/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201223/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201223/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201224/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201224/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201224/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201224/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201225/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201225/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201225/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201225/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201226/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201226/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201226/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201226/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201227/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201227/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201227/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201227/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201228/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201228/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201228/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201228/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201229/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201229/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201229/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201229/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201230/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201230/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201230/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201230/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201231/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201231/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201231/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20201231/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210101/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210101/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210101/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210101/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210102/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210102/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210102/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210102/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210103/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210103/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210103/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210103/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210104/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210104/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210104/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210104/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210105/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210105/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210105/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210105/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210106/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210106/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210106/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210106/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210107/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210107/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210107/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210107/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210108/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210108/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210108/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210108/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210109/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210109/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210109/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210109/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210110/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210110/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210110/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210110/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210111/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210111/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210111/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210111/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210112/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210112/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210112/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210112/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210113/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210113/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210113/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210113/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210114/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210114/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210114/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210114/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210115/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210115/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210115/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210115/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210116/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210116/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210116/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210116/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210117/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210117/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210117/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210118/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210118/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210118/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210118/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210119/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210119/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210119/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210119/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210120/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210120/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210120/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210120/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210121/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210121/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210123/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210123/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210123/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210123/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210124/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210124/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210124/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210124/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210125/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210125/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210125/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210125/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210126/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210126/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210126/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210126/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210127/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210127/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210127/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210127/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210128/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210128/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210128/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210128/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210129/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210129/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210129/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210129/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210130/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210130/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210130/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210130/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210131/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210131/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210131/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210131/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210201/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210201/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210201/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210201/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210202/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210202/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210202/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210202/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210203/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210203/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210203/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210203/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210204/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210204/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210204/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210204/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210205/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210205/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210205/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210205/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210206/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210206/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210206/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210206/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210207/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210207/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210207/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210207/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210208/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210208/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210208/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210208/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210209/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210209/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210209/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210209/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210210/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210210/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210210/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210210/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210211/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210211/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210211/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210211/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210212/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210212/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210212/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210212/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210213/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210213/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210213/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210213/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210214/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210214/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210214/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210214/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210215/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210215/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210215/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210215/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210216/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210216/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210216/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210216/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210217/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210217/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210217/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210217/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210218/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210218/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210218/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210218/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210219/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210219/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210219/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210219/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210220/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210220/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210220/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210220/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210221/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210221/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210221/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210221/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210222/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210222/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210222/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210222/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210223/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210223/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210223/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210223/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210224/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210224/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210224/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210224/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210225/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210225/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210225/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210225/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210226/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210226/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210226/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210226/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210227/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210227/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210227/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210227/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210228/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210228/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210228/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210228/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210301/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210301/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210301/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210301/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210302/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210302/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210302/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210302/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210303/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210303/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210303/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210303/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210304/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210304/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210304/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210304/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210305/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210305/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210305/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210305/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210306/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210306/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210306/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210306/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210307/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210307/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210307/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210307/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210308/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210308/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210308/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210308/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210309/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210309/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210309/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210309/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210310/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210310/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210310/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210310/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210311/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210311/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210311/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210311/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210312/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210312/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210312/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210312/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210313/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210313/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210313/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210313/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210314/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210314/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210314/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210314/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210315/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210315/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210315/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210315/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210316/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210316/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210316/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210316/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210317/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210317/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210317/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210317/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210318/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210318/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210318/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210318/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210319/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210319/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210319/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210319/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210320/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210320/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210320/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210320/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210321/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210321/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210321/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210321/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210322/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210322/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210322/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210322/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210323/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210323/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210323/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210323/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210324/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210324/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210324/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210324/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210325/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210325/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210325/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210325/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210326/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210326/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210326/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210326/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210327/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210327/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210327/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210327/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210328/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210328/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210328/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210328/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210329/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210329/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210329/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210329/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210330/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210330/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210330/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210330/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210331/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210331/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210331/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210331/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210401/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210401/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210401/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210401/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210402/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210402/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210402/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210402/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210403/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210403/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210403/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210403/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210404/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210404/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210404/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210404/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210405/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210405/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210405/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210405/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210406/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210406/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210406/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210406/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210407/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210407/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210407/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210407/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210408/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210408/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210408/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210408/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210409/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210409/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210409/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210409/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210410/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210410/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210410/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210410/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210411/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210411/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210411/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210411/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210412/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210412/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210412/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210412/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210413/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210413/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210413/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210413/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210414/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210414/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210414/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210414/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210415/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210415/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210415/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210415/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210416/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210416/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210416/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210416/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210417/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210417/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210417/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210417/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210418/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210418/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210418/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210418/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210419/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210419/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210419/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210419/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210420/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210420/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210420/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210420/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210421/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210421/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210421/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210421/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210422/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210422/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210422/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210422/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210423/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210423/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210423/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210423/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210424/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210424/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210424/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210424/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210425/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210425/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210425/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210425/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210426/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210426/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210426/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210426/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210427/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210427/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210427/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210427/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210428/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210428/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210428/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210428/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210429/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210429/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210429/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210429/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210430/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210430/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210430/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210430/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210501/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210501/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210501/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210501/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210502/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210502/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210502/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210502/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210503/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210503/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210503/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210503/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210504/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210504/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210504/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210504/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210505/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210505/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210505/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210505/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210506/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210506/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210506/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210506/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210507/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210507/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210507/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210507/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210508/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210508/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210508/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210508/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210509/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210509/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210509/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210509/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210510/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210510/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210510/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210510/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210511/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210511/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210511/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210511/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210512/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210512/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210512/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210512/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210513/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210513/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210513/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210513/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210514/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210514/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210514/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210514/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210515/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210515/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210515/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210515/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210516/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210516/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210516/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210516/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210517/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210517/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210517/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210517/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210518/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210518/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210518/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210518/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210519/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210519/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210519/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210519/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210520/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210520/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210520/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210520/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210521/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210521/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210521/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210521/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210522/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210522/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210522/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210522/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210523/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210523/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210523/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210523/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210524/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210524/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210524/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210524/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210525/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210525/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210525/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210525/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210526/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210526/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210526/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210526/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210527/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210527/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210527/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210527/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210528/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210528/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210528/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210528/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210529/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210529/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210529/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210529/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210530/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210530/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210530/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210530/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210531/blend.t00z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210531/blend.t06z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210531/blend.t12z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210531/blend.t18z.qmd.f096.WR.grib2',\n",
       " '/scratch/general/lustre/u1070830/nbm/20210601/blend.t00z.qmd.f096.WR.grib2']"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nbm_raw = np.array(sorted([f for f in sorted(glob(nbm_dir + '*/*.grib2'))]))\n",
    "nbm_raw \n",
    "\n",
    "for forecast_hour in np.arange(96, 96+1, 24):\n",
    "\n",
    "    list_new_extracts = []\n",
    "    for run in fill_runs:        \n",
    "            try:\n",
    "                list_new_extracts.append([f for f in nbm_raw if (\n",
    "                    (run.strftime('%Y%m%d') in f) & \n",
    "                    ('t%02dz.qmd.f%03d'%(run.hour, forecast_hour) in f))][0])\n",
    "            except:\n",
    "                pass\n",
    "\n",
    "    list_new_extracts = sorted(list_new_extracts)\n",
    "    break\n",
    "    \n",
    "#     workers = min(core_limit, len(list_new_extracts))\n",
    "#     print('Extracting %d NBM data files using %d processes'%(len(list_new_extracts), workers))\n",
    "\n",
    "#     with mp.get_context('fork').Pool(core_limit) as p:\n",
    "#         p.map(extract_fhr_data, list_new_extracts, chunksize=1)\n",
    "#         p.close()\n",
    "#         p.join()\n",
    "        \n",
    "#     gc.collect()\n",
    "\n",
    "list_new_extracts"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "list_new_extracts_nc = glob(nbm_dir + 'extract/*.nc')\n",
    "months = np.unique([f.split('.')[1][:6] for f in list_new_extracts_nc])\n",
    "\n",
    "for month in months:\n",
    "    \n",
    "    for forecast_hour in np.arange(48, 168+1, 24):\n",
    "        \n",
    "        print('Working: %s F%03d'%(month, forecast_hour))\n",
    "        \n",
    "        month_files = [f for f in list_new_extracts_nc if month in f]\n",
    "        # print(month_files)\n",
    "        \n",
    "        month_data_new = xr.open_mfdataset(month_files, concat_dim='valid')\n",
    "\n",
    "        # Find existing aggregate if it exists:\n",
    "        append_to_file = nbm_dir + 'agg/blend.%s.qmd.f%03d.WR.nc'%(month, forecast_hour)\n",
    "        \n",
    "        if os.path.isfile(append_to_file):\n",
    "            \n",
    "            append_to_ds = xr.open_dataset(append_to_file)\n",
    "            \n",
    "            existing_valid_times = append_to_ds.valid.values\n",
    "            new_valid_times = month_data_new.valid.values\n",
    "            \n",
    "            sel_new_valid_times = [t for t in new_valid_times if t not in existing_valid_times]\n",
    "            \n",
    "            if len(sel_new_valid_times) > 0:\n",
    "            \n",
    "                save_out_new = xr.concat(\n",
    "                        [append_to_ds, month_data_new.sel(valid=sel_new_valid_times)], \n",
    "                    dim='valid')\n",
    "                \n",
    "                # Manually fix the encoding issues...\n",
    "                save_out_new['init'].encoding['units'] = 'hours since 2000-01-01 00:00:00'\n",
    "                save_out_new['valid'].encoding['units'] = 'hours since 2000-01-01 00:00:00'\n",
    "            \n",
    "                save_out_new.to_netcdf(append_to_file + '.new')\n",
    "                del save_out_new\n",
    "                \n",
    "            append_to_ds.close()\n",
    "            \n",
    "            del append_to_ds, month_data_new\n",
    "            gc.collect()\n",
    "            \n",
    "        else:        \n",
    "            month_data_new.to_netcdf(append_to_file)\n",
    "            \n",
    "            del month_data_new\n",
    "            gc.collect()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# # Verify that the new file didn't corrupt the existing data!\n",
    "# new_agg_temp = sorted([f for f in glob(nbm_dir + 'extract_new/*.nc') if '.new.' in f])\n",
    "# new_agg_check = sorted([f for f in glob(nbm_dir + 'extract_new/*.nc') if '.new.' not in f])\n",
    "# old_agg_check = sorted(glob(nbm_dir + 'extract/*.nc'))\n",
    "\n",
    "# for temp_file, new_file, old_file in zip(new_agg_temp, new_agg_check, old_agg_check):\n",
    "    \n",
    "#     try:\n",
    "#         new = xr.open_dataset(new_file)\n",
    "#         old = xr.open_dataset(old_file)\n",
    "    \n",
    "#     except:\n",
    "#         pass\n",
    "    \n",
    "#     else:\n",
    "#         if new.valid[-1] > old.valid[-1]:\n",
    "#             print('New aggregate %s updated, check...'%os.path.basename(new_file))\n",
    "\n",
    "#             try:\n",
    "#                 os.remove(temp_file)\n",
    "#                 print(temp_file, '-->', 'deleted')\n",
    "#             except:\n",
    "#                 pass\n",
    "            \n",
    "#             try:\n",
    "#                 shutil.move(old_file, old_file.replace('.nc', '.old.nc'))\n",
    "#                 print(old_file, '-->', old_file.replace('.nc', '.old.nc'))\n",
    "#             except:\n",
    "#                 pass\n",
    "\n",
    "#             try:\n",
    "#                 shutil.move(new_file, new_file.replace('extract_new', 'extract'))\n",
    "#                 print(new_file, '-->', new_file.replace('extract_new', 'extract'))\n",
    "#             except:\n",
    "#                 pass\n",
    "\n",
    "#         else:\n",
    "#             print('New aggregate %s failed, follow up...'%os.path.basename(new_file))\n",
    "\n",
    "#         print()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
